services:
  # OpenWrt builder container
  openwrtbuilder:
    image: arthurcadore/openwrt-build:19
    volumes: 
      - ./build/:/host/
      - ./includes/:/host/includes/
      - ./custom/:/host/custom/
      - ./output/:/host/output/
      - ./docker/entrypoint.sh:/startup.sh
      - ./config/.config:/host/.config
      - ./config/feeds.conf:/host/feeds.conf
      - ./config/feeds.conf.default:/host/feeds.conf.default
    container_name: openwrtbuilder
    working_dir: /host/
    entrypoint: ["/bin/sh", "/startup.sh"]
    env_file:
      - ./env/.git_credentials

  # http server to serve the output files to be downloaded for testing.
  httpserver:
    image: httpd:alpine3.18
    container_name: httpserver
    restart: always
    ports:
      - "8080:80"
    volumes:
      - "./output/:/usr/local/apache2/htdocs/"